---

# SECURITY BY CURIOSITY
Graduate Program 2023
```
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣤⣄⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⠶⠛⠉⠀⠀⠀⠀⠉⠙⠶⠦⣀⡀⠀⠀⠀⣀⣠⠴⠶⠞⠛⠛⠶⠤⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡴⠛⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⠲⣞⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠈⢳⡄⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⠞⠁⠀⠀⠀⠀⠀⣀⣠⡤⠤⠤⠤⣤⣄⡀⠀⠀⠹⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢳⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⣴⠃⠀⠀⠀⠀⢠⠶⠛⠉⠁⠀⠀⠀⠀⠀⠈⠙⠓⠦⢤⣿⠤⠖⠒⠒⠒⠒⠒⠚⠒⠓⠲⠾⢧⡀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣰⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⣤⡤⠤⠤⠤⠤⣭⣳⣤⡀⠀⠀⠀⢀⣀⣀⣠⣤⣤⣤⣬⣙⣳⣦⣄⠀⠀
⠀⠀⠀⠀⢀⣀⣿⣷⣦⣤⣄⣀⡀⠀⣀⣀⣤⣤⣤⣶⣯⣭⣥⣶⣶⣯⣭⣽⣶⣶⣬⣭⣙⣴⢖⣫⣭⣿⣿⣶⣶⣶⣶⣶⣾⣿⣿⣿⣷⣤
⠀⠀⠀⣤⠛⢹⡇⠈⠉⠙⠻⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⡿⣿⣿⣿⣿
⠀⢀⡞⠁⠀⠸⠇⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿⣿⣽⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡣⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⣿⣿
⢀⡾⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡁⢹⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⡞⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⣿⣿⣿⣿⣿⡿⠛⠉⠉⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠻⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠁⠀⠀⣀⠀⠙⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠿
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠉⠉⣉⣩⡭⠿⠛⠉⠁⠀⠀⠀⠀⠀⠙⠛⢿⡒⠛⠛⠛⠋⠻⡭⡉⠁⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⣀⠀⠀⠀⠀⠀⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠀⠀⠀⠀⠀⠀⠹⣦⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡾⠛⠉⠉⠉⠳⣦⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⡄⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀⢀⣀⠀⠀⠀⠉⠙⠳⠦⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣇⡀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢷⡄⠀⠈⠉⠛⠢⢤⣤⣀⠀⠀⠈⠉⠉⠑⠒⠒⠒⠢⠤⢤⣤⣤⣤⣤⣄⣠⣤⣤⡤⠔⠚⠋⠁⢀⡇⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠛⢦⣄⡀⠀⠀⠀⠈⠉⠙⠓⠒⠦⢦⣤⣤⣄⣀⣀⣀⣀⣀⣀⠀⠀⠈⠁⠀⢀⣀⣀⣠⣤⠖⠉⠀⠀
⠛⣻⣶⣦⣤⣄⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠛⠲⢤⣤⣀⣀⠀⠀⠀⠀⠀⠀⠁⠀⠈⠀⠉⠀⠉⠉⠉⠉⠉⣉⣉⣤⣥⣷⠾⠓⢲⣚⡟
⠈⣞⣷⣴⣌⣽⣫⣿⠷⣤⣄⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠙⠛⠛⠛⠛⠛⠷⠶⠶⠶⠶⢶⢦⣤⣤⣴⢿⣯⡉⠉⣁⣞⠗⢂⠹⡝⠅
⠀⣻⣿⣷⢪⣿⣋⠀⠀⢀⡈⣽⡛⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⡟⣛⣍⣿⢷⡆⣈⣻⣮⠀⣻⣧⢿⣷⣶⠾
⠿⣿⣿⠾⠿⣿⡿⣵⣿⡏⣿⠹⣿⣞⢷⣄⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⣴⠟⡾⣿⣹⣿⣿⢷⡽⣏⠛⠓⠒⠛⠛⠛⠛⠛
⡼⢭⠥⣴⠬⣿⠿⢯⡿⢥⡿⢧⡿⢿⡿⢯⠭⢭⡿⢿⡿⢿⡿⢶⡶⢶⡾⢾⡿⢿⡭⢿⣿⠼⣧⠍⣭⠭⣥⠬⣷⢻⣆⣀⣦⣀⣴⣀⣀⠀
⢱⡿⠶⠿⠶⠾⠶⠾⠶⠾⠷⠾⠶⠾⠷⠾⠶⠾⠷⠾⠷⠾⠷⠾⠷⠾⠟⠛⠻⠞⠛⠛⠛⠛⠛⠛⠛⠋⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⢹⡀
⢸⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡇
```
---

```
~~~chafa img/whitehat-hacker.jpg
whitehat-hacker
~~~
```
Whitehat, show them the video...

[Counterattack | The 47th brigade "Magura" breaks through the defense of the russians in the south](https://youtu.be/bk5OG6JYmfI?si=b99kw5CxFBqGtJlK&t=2026)

---

# Security: A Game of Resources

- Security is sometimes sold through fear.
- This tends to lead to poor decision making
- To make good decision we need to conserve our resources

## Tales from The Security Operations Center

- External scan vs Internal scan
- Alert fatigue

## Discussion
- Discuss: What threats have you observed in your online life? Bots, spam, phishing, bad urls etc
- Discuss: How much of a threat is a phishing email?
- Discuss: How much more of a threat is a spearphishing email?

```
.---------------------------------.           
|  .---------------------------.  |           
|[]|                           |[]|           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  `---------------------------'  |           
|      __________________ _____   |           
|     |   ___            |     |  |           
|     |  |   |           |     |  |           
|     |  |   |           |     |  |           
|     |  |   |           |     |  |           
|     |  |___|           |     |  |           
\_____|__________________|_____|__|
```
---

# Who is this course for?

- Anyone who is just getting starded in Tech industry
- If you want to learn about CyberSecurity from an Attacker’s perspective
- If you want to know what a cyber attack looks like in practice
- If you want to get hands dirty and try some hacking techniques on each other
- Get Hands on experience with Phishing / Command & Control / Network Pivoting


```
~~~graph-easy --as=boxart
[ It's ] - too -> [ easy ]
~~~
```

```       .------..
     -          -
   /              \
 /                   \
/    .--._    .---.   |
|  /      -__-     \   |
| |                 |  |
 ||     ._   _.      ||
 ||      o   o       ||
 ||      _  |_      ||
 C|     (o\_/o)     |O     Uhhh, this computer
  \      _____      /       is like, busted or
    \ ( /#####\ ) /       something. So go away.
     \  `====='  /
      \  -___-  /
       |       |
       /-_____-\
     /           \
   /               \
  /__|  AC / DC  |__\
  | ||           |\ \
```
---

# Goal of Today

- You will have commited a hands-on-keyboard simulated cyber-attack
- You will have learned how easy it is to be on the attack side
- You will learn some tactics, techniques and procedures for red team engagements

# NOTE
- You will NOT learn how to defend against these attacks
- We will focus on methodology for conducting attacks
- The attack mindset is much more valuable to establish than focusing on defense

# DISCUSS

Defending is harder than attacking

- Why do you think defending is harder than attacking?

```
================================================.
     .-.   .-.     .--.       GOAL              |
    | OO| | OO|   / _.-' .-.   .-.  .-.   .''.  |
    |   | |   |   \  '-. '-'   '-'  '-'   '..'  |
    '^^^' '^^^'    '--'                         |
===============.  .-.  .================.  .-.  |
               | |   | |                |  '-'  |
               | |   | |                |       |
               | ':-:' |                |  .-.  |
               |  '-'  |                |  '-'  |
==============='       '================'       |
```
---

# $ whoami
Alexander Reinthal
35y
- Former Cyber Security Analyst
- Current Data Engineer / Data Scientist
- Father / Sambo
- Tech lover
- Musician
- Gamer

---
# Outline
## Talkthrough of Attack Scenario: Zeegma Corporate Espionage
## Cyber Kill Chain
## Exercise I: Sending & Clicking on Phishing Emails 🎣
## Exercise II: Infecting Ourselves with malware 🤣 🦟
## Exercise III: Local Network Attacks & Other lulz (If enough time)
## Talkthrough: Selling Initial Access & Shodan 🏆 💸
## Digging deeper: Network Pivoting & Beyond ⛰️
## Summary 🧮

---
# Background on Cyber Kill Chain 
- The kill chain was originally developed by US government contractor Lockheed Martin in 2010ish
- It models how cyber attacks are conducted
- Can be a good mental model, not very useful in practice
- Today, other frameworks exists like MITRE-attack framework an the unified kill chain.

---
# Cyber Kill Chain (1/2)

## Reconnaissence 🔎

This is where attackers spend most of their time. Searching for clues on how to attack a target.

Typical valuable information is, emails, customers, IT infrastructure, domain names etc

## Weaponisation 🗡️, use info from recon to attack

The above information is compiled into something useful, like an email list to be used in a phishing attack.

It can also be used to compile an internet-facing IT asset list for vulnerability scanning.

## Delivery 🚚, engage target 

The weapon is delivered. In the case of phishing, you click send.

---
# Cyber Kill Chain (2/2)

## Exploitation 😈, use weakness

The target is baited into clicking the link, because the email said that HR had gotten a complaint of discrimination by the employee. 

hehe : ) or something like that.

## Installation 💾, install malware

The target downloads malware and gets infected from the link.

## Command & Control 🕹️, use compromised targets to further goals & objectives

The infected target phones home to an attacker controlled server.

## Actions on Objectives 🎯, get the info

The attacker can now use the infections to further their objectives and burrow deeper into the network.

---
# A Lightweight Cyber Kill Chain

Today we will do something like this
```
~~~graph-easy --as=boxart
[Recon1:Get knowit emails] - delivery -> [ Phish Targets ]
[ Phish Targets ] - login to o365 -> [ Recon2: Get CRM Users ]
[ Recon2: Get CRM Users ] - delivery -> [ Phish Targets ]
[ Phish Targets ] - login to CRM -> [ Primary Objective: Extract Data from CRM]
~~~
```
## Above kill chain is more similar to the unified kill chain
## Typically, attackers spend most time in the Recon phase

---


# Attack Scenario: Zeegma Corporate espionage against Knowit Solutions Cocreate

- You are cyber mercenaries who have been contracted to perform 
corporate espionage against Knowit Solutions Cocreate.
- Your employer, Zeegma, has been falling behind its competitor Cocreate
- Zeegma is desperate to know why all its customers have left to Knowit Solutions Cocreate. 


---



# Zeegma Hacking Objectives:

Here are your objectives

## **Primary Objective** 
is to compromise Cocreate's customer relationship management platform (CRM) by hacking users o365 accounts.
Using hacked accounts, you will relay customer relations information to Zeegma, and brief them on your findings.

## **Secondary Objective** 

is to establish persistance inside Cocreate's environment so that the Zeegma can repeatedly extract business intelligence from the victim.

### What is persistance?

- Persistance is typically a backdoor into an IT system.
- In general, it is any mechanism that let's the adversary to keep its foothold in the target organisation, 
- **Examples**: Custom admin access to the CRM, A rogue Office 365 account, a remote access trojan or similar.

---
# Action Plan (1/3) The CRM System:
### Reconnaissence 1
-  Find some email addresses of Cocreate

### Phish the Target
-  Send targeted phishing emails

### Initial Foothold
-  Login to o365 using compromised 2fa tokens

### Reconnaissence 2

-  Search emails, teams and other instant messages for references to the CRM system

---
# Action Plan (2/3): Primary Objective, The CRM System

Here what we will do to acheive the primary objective:

## Weaponization

- Figure who is uses the CRM system from the info collected.

## Phish the CRM Users
- Send more phishing emails, targeting users of the CRM system this time, get the login and password.
## Execute on Primary Objective
- Login to the CRM system and extract the necessary data.

---

# Action Plan (3/3): Secondary Objective, Establish Persistance

## Recon 3 & Weaponization

- Figure out who is domain admin in invativas active directory

## Exploitation

- Phish the domain administrators

## Execute on Secondary Objective

- Create a backdoor o365 account


---

# Exercise Hacking Time: Phish or Get Phished
```
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⢋⣠⣼⣿⣿⣦⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⣴⣿⣿⣿⣿⣿⣿⣧⠹⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⣁⡤⣭⣿⣿⣿⣿⣿⣿⣿⡇⢹⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⠉⠻⢷⣬⡻⣟⢿⣿⣿⣿⠻⠈⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠀⠈⣿⣷⣎⢻⣮⠳⣹⣿⣿⢣⡄⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⠀⢀⣌⢹⣯⡀⠹⣷⡀⣿⣿⢸⣧⢹⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡀⠀⠈⢸⣿⣿⣷⡹⣷⣹⡇⣿⣿⡜⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⠀⠀⠀⠘⣿⣿⣷⡽⣿⢸⣿⣿⡗⣬⠻⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠇⠀⠀⠀⠙⠛⣩⢰⢇⣿⠿⢋⣴⣿⣷⣝⢿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠁⣾⠆⠀⠀⠀⠈⠁⣂⣩⣵⡆⠿⣻⣿⣿⣿⣷⡜⢿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢠⠸⠏⡔⡄⡶⣶⣿⠀⢹⣿⣿⢇⢰⣿⣿⣿⣿⣿⣿⡸
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡗⢸⢸⣷⡇⡇⡇⣿⣿⢸⢸⣿⣿⣾⣄⢻⢟⣽⣿⣿⣿⣧
⡛⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⣤⣬⢸⣿⣇⢹⡇⣿⡟⠀⣿⣿⣿⣿⠏⠀⠊⢹⣿⣿⣿⣿
⣷⡄⠈⠙⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⢀⠙⠿⢸⣿⡘⢸⣿⣿⡅⢠⣿⣿⣿⡏⣶⠏⣠⣵⠟⣽⣿⢇
⣿⣿⡄⠀⠀⠈⠙⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⡘⢦⣅⣀⢸⣿⣧⣸⣿⣿⡇⠘⣿⣿⡟⣼⠁⠳⣶⣖⣒⣲⠶⢸
⣿⣿⣿⣄⠀⠀⠀⠀⠀⠙⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠡⠴⣿⣷⣿⢌⠘⣿⣿⣿⣿⣿⡇⢰⣿⣿⢡⡏⣶⣶⣶⣶⣶⣬⡄⣼
⣿⣿⣿⣿⣆⠀⠀⠀⠀⠀⠀⠈⢻⣿⣿⡿⠿⣟⣛⠛⠛⣛⣡⣬⡟⣷⢹⣿⡜⠇⠁⣹⣿⣿⣿⣿⣿⡿⠿⢃⣾⢀⣷⠶⠶⠭⢭⣝⢃⣿
⣿⣿⣿⣿⣿⣧⠀⠀⠀⠀⠀⠀⠀⠱⠂⠉⠛⢉⡴⠛⣼⠟⢙⡿⢃⡙⠁⢛⣥⠠⠾⠿⠿⠿⠿⣿⠿⠷⠿⠟⠁⠺⣿⣮⣽⣛⣳⠖⢸⣿
⣿⣿⣿⣿⣿⣿⣧⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢾⠅⡾⠡⠶⢋⣠⢿⣿⣿⣿⣾⣇⢺⣿⣷⡈⣷⣰⣦⣿⡆⢤⣿⡶⣿⣿⣿⠿⠿⠃⢸⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠂⠀⢠⡞⣩⠞⢋⣽⠿⠿⠿⠏⠾⠿⠿⠇⣿⣿⣿⣿⣷⣾⣿⣿⣷⣿⠟⣣⣴⠟⣾⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⡀⠀⠀⠀⢠⡀⠀⠀⠈⢠⡴⠚⠩⠶⣿⣷⡾⢿⣛⣥⣀⠈⢙⡿⠟⠿⣝⠻⠿⢟⣫⣴⣾⣿⠃⣼⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣄⠀⠀⢻⣷⣄⠀⠀⡀⠤⠖⣛⣭⣶⣾⣿⣿⣿⣿⣿⣶⣭⡛⢿⣶⣾⣿⣿⣿⣿⣿⡿⢀⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⡀⠛⠛⣋⣠⣴⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣮⣛⣿⣿⣿⣿⣿⡖⣸⣿⣿⣿
```

---

# Exercise Hacking Time

## Show & Tell

Let's go around the table and read each other's phishing emails.
Then we do a vote on wrote the best email! : D

## Get phished

- I will log in to a VPS I have setup and start the phishing server for o365
- At my command, click this link [Totally legit link](https://login.know1t.dev/bFclQKxa)
- Authenticate against it 
- We will read through the logs together

---

# Get Phished

## Step 1: Click the link
## Step 2: Let user go through the authentication flow
## Step 3: Look in the Evilginx2 logs
## Step 4: Run this command

```bash
sessions
```
Followed by
```bash
sessions n
```

where `n` is the session that was captured. Copy paste the JSON.

## Step 5: Open the below URL in Brave

https://portal.office.com

## Step 6: Use the cookie editor

- Clear current cookies
- Import the cookie in clipboard

## Step 7: Refresh portal.office.com

- You should now be logged in as the phished user. 

## Step 8: Experiment :)

- Feel free to share tokens with each other to log in as the other user
- To Copy-paste cookies, use this chrome extension https://chrome.google.com/webstore/detail/cookie-editor/hlkenndednhfkekhgcdicdfddnkalmdm?hl=en

---

# Command & Control (c2) 
```
⠀⠀⠀⠀⠀⣀⣠⠤⠶⠶⣖⡛⠛⠿⠿⠯⠭⠍⠉⣉⠛⠚⠛⠲⣄⠀⠀⠀⠀⠀
⠀⠀⢀⡴⠋⠁⠀⡉⠁⢐⣒⠒⠈⠁⠀⠀⠀⠈⠁⢂⢅⡂⠀⠀⠘⣧⠀⠀⠀⠀
⠀⠀⣼⠀⠀⠀⠁⠀⠀⠀⠂⠀⠀⠀⠀⢀⣀⣤⣤⣄⡈⠈⠀⠀⠀⠘⣇⠀⠀⠀
⢠⡾⠡⠄⠀⠀⠾⠿⠿⣷⣦⣤⠀⠀⣾⣋⡤⠿⠿⠿⠿⠆⠠⢀⣀⡒⠼⢷⣄⠀
⣿⠊⠊⠶⠶⢦⣄⡄⠀⢀⣿⠀⠀⠀⠈⠁⠀⠀⠙⠳⠦⠶⠞⢋⣍⠉⢳⡄⠈⣧
⢹⣆⡂⢀⣿⠀⠀⡀⢴⣟⠁⠀⢀⣠⣘⢳⡖⠀⠀⣀⣠⡴⠞⠋⣽⠷⢠⠇⠀⣼
⠀⢻⡀⢸⣿⣷⢦⣄⣀⣈⣳⣆⣀⣀⣤⣭⣴⠚⠛⠉⣹⣧⡴⣾⠋⠀⠀⣘⡼⠃
⠀⢸⡇⢸⣷⣿⣤⣏⣉⣙⣏⣉⣹⣁⣀⣠⣼⣶⡾⠟⢻⣇⡼⠁⠀⠀⣰⠋⠀⠀
⠀⢸⡇⠸⣿⡿⣿⢿⡿⢿⣿⠿⠿⣿⠛⠉⠉⢧⠀⣠⡴⠋⠀⠀⠀⣠⠇⠀⠀⠀
⠀⢸⠀⠀⠹⢯⣽⣆⣷⣀⣻⣀⣀⣿⣄⣤⣴⠾⢛⡉⢄⡢⢔⣠⠞⠁⠀⠀⠀⠀
⠀⢸⠀⠀⠀⠢⣀⠀⠈⠉⠉⠉⠉⣉⣀⠠⣐⠦⠑⣊⡥⠞⠋⠀⠀⠀⠀⠀⠀⠀
⠀⢸⡀⠀⠁⠂⠀⠀⠀⠀⠀⠀⠒⠈⠁⣀⡤⠞⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠙⠶⢤⣤⣤⣤⣤⡤⠴⠖⠚⠛⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
```

---

# What is Command & control / C2?

Command & control (c2) a client / server infrastructure for infected users. 

- Using a c2 framework, a botmaster can send commands to be executed by the all the infected users
- Infected users are usually referred to as bots, hence "botnet"

## Typical Commands to execute are
- Extract cookies from web browsers
- Search the users files for passwords
- Log keystrokes

## Fun Commands you can execute
- Turn on web-camera
- Open Calculator
- Turn on microphone
- Play sounds 


---

# Command & Control Frameworks (2/2)

Using a c2 framework is in red team engagements is common today and has many benifits:

- Facilitates collaboration
- Centralizes management of bots
- I dont know what else, ask a red teamer : )

## Covenant

Open source .NET C2 Framework. This is what we will be using in our exercise in the next slide!


## Cobalt Strike

- Comercial product. Industry leader for C2 platform.
- It's so good that even the bad guys use it

link: https://www.cobaltstrike.com/

## Further Reading

Here is a larger list of c2 frameworks if you want to test and play around a bit.

https://github.com/tcostam/awesome-command-control

---

# Infecting Ourselves with Covenant


## Here's our covenant payload

If you didn't get it from the previous step here it is:

http://c2.know1t.dev/knowitsolutionscocreatefalkenberg-2023-com/program.exe

I will distribute it in the chat also

## What is this program?

This is a C# implant of the Covenant family. It targets dotnet 4.0, this should be pre-installed on most windows machines

# Who can Detect it?

Let's go to virustotal and see who can detect it! : )

# What happens when I run it?

I will demo what happens

## Login to arch Frogman box
## demonstrate that it is not detected by Anti-Virus
## Execute it
## Go to Covenant Command & Control Panel
## Execute command

- List Directory
- Take Screenshots
- Run Keylogger
- Notice the Persist* commands 

## Discussion:

- What are the necessary user-interaction steps to get this payload executing on a workstation for an attacker?
- What does the attack chain look like? From phish to infection
- What countermeasures do we need to defeat as an attacker?
- How can a developer design programs that circumvent these tactics?
---

# But wait ...

## "This isn't hacking, it's just social engineering..."

Yes. And it's the most effective way when you want to target a specific organisation.


# Another tactic is 
- to scan the internet for vulnerable services, and exploit and then recon.
- When you find a juicy potatoe then you launch attack. 
- Or sell initial access to highest bidder, and let someone else ransomware the infected network.

## Shodan.io

is a website that shows internet exposed services. Start here to find vulnerable services



---

# Summary

## We have talked about Cyber-kill chain
## We have talked about reconnaisence
## We have demoed how to phish
## We have looked at post infection

https://virustotal.com


