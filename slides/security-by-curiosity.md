---

# SECURITY BY CURIOSITY
Graduate Program 2023
```
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£Ä‚£§‚£Ñ‚£Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£†‚†∂‚†õ‚†â‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚†ô‚†∂‚†¶‚£Ä‚°Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£†‚†¥‚†∂‚†û‚†õ‚†õ‚†∂‚†§‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚°¥‚†õ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†ô‚†≤‚£û‚†ã‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚¢≥‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚†û‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£†‚°§‚†§‚†§‚†§‚£§‚£Ñ‚°Ä‚†Ä‚†Ä‚†π‚£Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢≥‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£¥‚†É‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚†∂‚†õ‚†â‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†ô‚†ì‚†¶‚¢§‚£ø‚†§‚†ñ‚†í‚†í‚†í‚†í‚†í‚†ö‚†í‚†ì‚†≤‚†æ‚¢ß‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£∞‚†É‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£Ä‚£§‚°§‚†§‚†§‚†§‚†§‚£≠‚£≥‚£§‚°Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£Ä‚£Ä‚£†‚£§‚£§‚£§‚£¨‚£ô‚£≥‚£¶‚£Ñ‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£Ä‚£ø‚£∑‚£¶‚£§‚£Ñ‚£Ä‚°Ä‚†Ä‚£Ä‚£Ä‚£§‚£§‚£§‚£∂‚£Ø‚£≠‚£•‚£∂‚£∂‚£Ø‚£≠‚£Ω‚£∂‚£∂‚£¨‚£≠‚£ô‚£¥‚¢ñ‚£´‚£≠‚£ø‚£ø‚£∂‚£∂‚£∂‚£∂‚£∂‚£æ‚£ø‚£ø‚£ø‚£∑‚£§
‚†Ä‚†Ä‚†Ä‚£§‚†õ‚¢π‚°á‚†à‚†â‚†ô‚†ª‚†ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚£ø‚°ø‚£ø‚£ø‚£ø‚£ø
‚†Ä‚¢Ä‚°û‚†Å‚†Ä‚†∏‚†á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ò‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£Ω‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°£‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚£ø‚£ø‚£ø
‚¢Ä‚°æ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Å‚¢π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
‚°û‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†π‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†õ‚†â‚†â‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚†ª‚†ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†ü‚†Å‚†Ä‚†Ä‚£Ä‚†Ä‚†ô‚†ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†ø
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†â‚†â‚£â‚£©‚°≠‚†ø‚†õ‚†â‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚†õ‚¢ø‚°í‚†õ‚†õ‚†õ‚†ã‚†ª‚°≠‚°â‚†Å‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£Ä‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†π‚£¶‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚°æ‚†õ‚†â‚†â‚†â‚†≥‚£¶‚£Ñ‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ò‚°Ñ‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚†Ä‚†Ä‚¢Ä‚£Ä‚†Ä‚†Ä‚†Ä‚†â‚†ô‚†≥‚†¶‚£§‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£†‚£á‚°Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∑‚°Ñ‚†Ä‚†à‚†â‚†õ‚†¢‚¢§‚£§‚£Ä‚†Ä‚†Ä‚†à‚†â‚†â‚†ë‚†í‚†í‚†í‚†¢‚†§‚¢§‚£§‚£§‚£§‚£§‚£Ñ‚£†‚£§‚£§‚°§‚†î‚†ö‚†ã‚†Å‚¢Ä‚°á‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†õ‚¢¶‚£Ñ‚°Ä‚†Ä‚†Ä‚†Ä‚†à‚†â‚†ô‚†ì‚†í‚†¶‚¢¶‚£§‚£§‚£Ñ‚£Ä‚£Ä‚£Ä‚£Ä‚£Ä‚£Ä‚†Ä‚†Ä‚†à‚†Å‚†Ä‚¢Ä‚£Ä‚£Ä‚£†‚£§‚†ñ‚†â‚†Ä‚†Ä
‚†õ‚£ª‚£∂‚£¶‚£§‚£Ñ‚£Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†õ‚†≤‚¢§‚£§‚£Ä‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Å‚†Ä‚†à‚†Ä‚†â‚†Ä‚†â‚†â‚†â‚†â‚†â‚£â‚£â‚£§‚£•‚£∑‚†æ‚†ì‚¢≤‚£ö‚°ü
‚†à‚£û‚£∑‚£¥‚£å‚£Ω‚£´‚£ø‚†∑‚£§‚£Ñ‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚†ô‚†õ‚†õ‚†õ‚†õ‚†õ‚†∑‚†∂‚†∂‚†∂‚†∂‚¢∂‚¢¶‚£§‚£§‚£¥‚¢ø‚£Ø‚°â‚†â‚£Å‚£û‚†ó‚¢Ç‚†π‚°ù‚†Ö
‚†Ä‚£ª‚£ø‚£∑‚¢™‚£ø‚£ã‚†Ä‚†Ä‚¢Ä‚°à‚£Ω‚°õ‚£ø‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£º‚°ü‚£õ‚£ç‚£ø‚¢∑‚°Ü‚£à‚£ª‚£Æ‚†Ä‚£ª‚£ß‚¢ø‚£∑‚£∂‚†æ
‚†ø‚£ø‚£ø‚†æ‚†ø‚£ø‚°ø‚£µ‚£ø‚°è‚£ø‚†π‚£ø‚£û‚¢∑‚£Ñ‚£Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£Ä‚£¥‚†ü‚°æ‚£ø‚£π‚£ø‚£ø‚¢∑‚°Ω‚£è‚†õ‚†ì‚†í‚†õ‚†õ‚†õ‚†õ‚†õ
‚°º‚¢≠‚†•‚£¥‚†¨‚£ø‚†ø‚¢Ø‚°ø‚¢•‚°ø‚¢ß‚°ø‚¢ø‚°ø‚¢Ø‚†≠‚¢≠‚°ø‚¢ø‚°ø‚¢ø‚°ø‚¢∂‚°∂‚¢∂‚°æ‚¢æ‚°ø‚¢ø‚°≠‚¢ø‚£ø‚†º‚£ß‚†ç‚£≠‚†≠‚£•‚†¨‚£∑‚¢ª‚£Ü‚£Ä‚£¶‚£Ä‚£¥‚£Ä‚£Ä‚†Ä
‚¢±‚°ø‚†∂‚†ø‚†∂‚†æ‚†∂‚†æ‚†∂‚†æ‚†∑‚†æ‚†∂‚†æ‚†∑‚†æ‚†∂‚†æ‚†∑‚†æ‚†∑‚†æ‚†∑‚†æ‚†∑‚†æ‚†ü‚†õ‚†ª‚†û‚†õ‚†õ‚†õ‚†õ‚†õ‚†õ‚†õ‚†ã‚†â‚†â‚†â‚†â‚†â‚†â‚†â‚†â‚†â‚†â‚¢π‚°Ä
‚¢∏‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚°á
```
---

```
~~~chafa img/whitehat-hacker.jpg
whitehat-hacker
~~~
```
Whitehat, show them the video...

[Counterattack | The 47th brigade "Magura" breaks through the defense of the russians in the south](https://youtu.be/bk5OG6JYmfI?si=b99kw5CxFBqGtJlK&t=2026)

---

# Security: A Game of Resources

- Security is sometimes sold through fear.
- This tends to lead to poor decision making
- To make good decision we need to conserve our resources

## Tales from The Security Operations Center

- External scan vs Internal scan
- Alert fatigue

## Discussion
- Discuss: What threats have you observed in your online life? Bots, spam, phishing, bad urls etc
- Discuss: How much of a threat is a phishing email?
- Discuss: How much more of a threat is a spearphishing email?

```
.---------------------------------.           
|  .---------------------------.  |           
|[]|                           |[]|           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  |                           |  |           
|  `---------------------------'  |           
|      __________________ _____   |           
|     |   ___            |     |  |           
|     |  |   |           |     |  |           
|     |  |   |           |     |  |           
|     |  |   |           |     |  |           
|     |  |___|           |     |  |           
\_____|__________________|_____|__|
```
---

# Who is this course for?

- Anyone who is just getting starded in Tech industry
- If you want to learn about CyberSecurity from an Attacker‚Äôs perspective
- If you want to know what a cyber attack looks like in practice
- If you want to get hands dirty and try some hacking techniques on each other
- Get Hands on experience with Phishing / Command & Control / Network Pivoting


```
~~~graph-easy --as=boxart
[ It's ] - too -> [ easy ]
~~~
```

```       .------..
     -          -
   /              \
 /                   \
/    .--._    .---.   |
|  /      -__-     \   |
| |                 |  |
 ||     ._   _.      ||
 ||      o   o       ||
 ||      _  |_      ||
 C|     (o\_/o)     |O     Uhhh, this computer
  \      _____      /       is like, busted or
    \ ( /#####\ ) /       something. So go away.
     \  `====='  /
      \  -___-  /
       |       |
       /-_____-\
     /           \
   /               \
  /__|  AC / DC  |__\
  | ||           |\ \
```
---

# Goal of Today

- You will have commited a hands-on-keyboard simulated cyber-attack
- You will have learned how easy it is to be on the attack side
- You will learn some tactics, techniques and procedures for red team engagements

# NOTE
- You will NOT learn how to defend against these attacks
- We will focus on methodology for conducting attacks
- The attack mindset is much more valuable to establish than focusing on defense

# DISCUSS

Defending is harder than attacking

- Why do you think defending is harder than attacking?

```
================================================.
     .-.   .-.     .--.       GOAL              |
    | OO| | OO|   / _.-' .-.   .-.  .-.   .''.  |
    |   | |   |   \  '-. '-'   '-'  '-'   '..'  |
    '^^^' '^^^'    '--'                         |
===============.  .-.  .================.  .-.  |
               | |   | |                |  '-'  |
               | |   | |                |       |
               | ':-:' |                |  .-.  |
               |  '-'  |                |  '-'  |
==============='       '================'       |
```
---

# $ whoami
Alexander Reinthal
35y
- Former Cyber Security Analyst
- Current Data Engineer / Data Scientist
- Father / Sambo
- Tech lover
- Musician
- Gamer

---
# Outline
## Talkthrough of Attack Scenario: Zeegma Corporate Espionage
## Cyber Kill Chain
## Exercise I: Sending & Clicking on Phishing Emails üé£
## Exercise II: Infecting Ourselves with malware ü§£ ü¶ü
## Exercise III: Local Network Attacks & Other lulz (If enough time)
## Talkthrough: Selling Initial Access & Shodan üèÜ üí∏
## Digging deeper: Network Pivoting & Beyond ‚õ∞Ô∏è
## Summary üßÆ

---
# Background on Cyber Kill Chain 
- The kill chain was originally developed by US government contractor Lockheed Martin in 2010ish
- It models how cyber attacks are conducted
- Can be a good mental model, not very useful in practice
- Today, other frameworks exists like MITRE-attack framework an the unified kill chain.

---
# Cyber Kill Chain (1/2)

## Reconnaissence üîé

This is where attackers spend most of their time. Searching for clues on how to attack a target.

Typical valuable information is, emails, customers, IT infrastructure, domain names etc

## Weaponisation üó°Ô∏è, use info from recon to attack

The above information is compiled into something useful, like an email list to be used in a phishing attack.

It can also be used to compile an internet-facing IT asset list for vulnerability scanning.

## Delivery üöö, engage target 

The weapon is delivered. In the case of phishing, you click send.

---
# Cyber Kill Chain (2/2)

## Exploitation üòà, use weakness

The target is baited into clicking the link, because the email said that HR had gotten a complaint of discrimination by the employee. 

hehe : ) or something like that.

## Installation üíæ, install malware

The target downloads malware and gets infected from the link.

## Command & Control üïπÔ∏è, use compromised targets to further goals & objectives

The infected target phones home to an attacker controlled server.

## Actions on Objectives üéØ, get the info

The attacker can now use the infections to further their objectives and burrow deeper into the network.

---
# A Lightweight Cyber Kill Chain

Today we will do something like this
```
~~~graph-easy --as=boxart
[Recon1:Get knowit emails] - delivery -> [ Phish Targets ]
[ Phish Targets ] - login to o365 -> [ Recon2: Get CRM Users ]
[ Recon2: Get CRM Users ] - delivery -> [ Phish Targets ]
[ Phish Targets ] - login to CRM -> [ Primary Objective: Extract Data from CRM]
~~~
```
## Above kill chain is more similar to the unified kill chain
## Typically, attackers spend most time in the Recon phase

---


# Attack Scenario: Zeegma Corporate espionage against Knowit Solutions Cocreate

- You are cyber mercenaries who have been contracted to perform 
corporate espionage against Knowit Solutions Cocreate.
- Your employer, Zeegma, has been falling behind its competitor Cocreate
- Zeegma is desperate to know why all its customers have left to Knowit Solutions Cocreate. 


---



# Zeegma Hacking Objectives:

Here are your objectives

## **Primary Objective** 
is to compromise Cocreate's customer relationship management platform (CRM) by hacking users o365 accounts.
Using hacked accounts, you will relay customer relations information to Zeegma, and brief them on your findings.

## **Secondary Objective** 

is to establish persistance inside Cocreate's environment so that the Zeegma can repeatedly extract business intelligence from the victim.

### What is persistance?

- Persistance is typically a backdoor into an IT system.
- In general, it is any mechanism that let's the adversary to keep its foothold in the target organisation, 
- **Examples**: Custom admin access to the CRM, A rogue Office 365 account, a remote access trojan or similar.

---
# Action Plan (1/3) The CRM System:
### Reconnaissence 1
-  Find some email addresses of Cocreate

### Phish the Target
-  Send targeted phishing emails

### Initial Foothold
-  Login to o365 using compromised 2fa tokens

### Reconnaissence 2

-  Search emails, teams and other instant messages for references to the CRM system

---
# Action Plan (2/3): Primary Objective, The CRM System

Here what we will do to acheive the primary objective:

## Weaponization

- Figure who is uses the CRM system from the info collected.

## Phish the CRM Users
- Send more phishing emails, targeting users of the CRM system this time, get the login and password.
## Execute on Primary Objective
- Login to the CRM system and extract the necessary data.

---

# Action Plan (3/3): Secondary Objective, Establish Persistance

## Recon 3 & Weaponization

- Figure out who is domain admin in invativas active directory

## Exploitation

- Phish the domain administrators

## Execute on Secondary Objective

- Create a backdoor o365 account


---

# Exercise Hacking Time: Phish or Get Phished
```
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚¢ã‚£†‚£º‚£ø‚£ø‚£¶‚†ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ü‚£¥‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ß‚†π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ü‚£Å‚°§‚£≠‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á‚¢π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†Ä‚†â‚†ª‚¢∑‚£¨‚°ª‚£ü‚¢ø‚£ø‚£ø‚£ø‚†ª‚†à‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†Ä‚†à‚£ø‚£∑‚£é‚¢ª‚£Æ‚†≥‚£π‚£ø‚£ø‚¢£‚°Ñ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á‚†Ä‚¢Ä‚£å‚¢π‚£Ø‚°Ä‚†π‚£∑‚°Ä‚£ø‚£ø‚¢∏‚£ß‚¢π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ä‚†Ä‚†à‚¢∏‚£ø‚£ø‚£∑‚°π‚£∑‚£π‚°á‚£ø‚£ø‚°ú‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ß‚†Ä‚†Ä‚†Ä‚†ò‚£ø‚£ø‚£∑‚°Ω‚£ø‚¢∏‚£ø‚£ø‚°ó‚£¨‚†ª‚£ø‚£ø‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†á‚†Ä‚†Ä‚†Ä‚†ô‚†õ‚£©‚¢∞‚¢á‚£ø‚†ø‚¢ã‚£¥‚£ø‚£∑‚£ù‚¢ø‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ü‚†Å‚£æ‚†Ü‚†Ä‚†Ä‚†Ä‚†à‚†Å‚£Ç‚£©‚£µ‚°Ü‚†ø‚£ª‚£ø‚£ø‚£ø‚£∑‚°ú‚¢ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚¢†‚†∏‚†è‚°î‚°Ñ‚°∂‚£∂‚£ø‚†Ä‚¢π‚£ø‚£ø‚¢á‚¢∞‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°∏
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ó‚¢∏‚¢∏‚£∑‚°á‚°á‚°á‚£ø‚£ø‚¢∏‚¢∏‚£ø‚£ø‚£æ‚£Ñ‚¢ª‚¢ü‚£Ω‚£ø‚£ø‚£ø‚£ß
‚°õ‚†ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ü‚£§‚£¨‚¢∏‚£ø‚£á‚¢π‚°á‚£ø‚°ü‚†Ä‚£ø‚£ø‚£ø‚£ø‚†è‚†Ä‚†ä‚¢π‚£ø‚£ø‚£ø‚£ø
‚£∑‚°Ñ‚†à‚†ô‚†ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ü‚¢Ä‚†ô‚†ø‚¢∏‚£ø‚°ò‚¢∏‚£ø‚£ø‚°Ö‚¢†‚£ø‚£ø‚£ø‚°è‚£∂‚†è‚£†‚£µ‚†ü‚£Ω‚£ø‚¢á
‚£ø‚£ø‚°Ñ‚†Ä‚†Ä‚†à‚†ô‚†ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ü‚°ò‚¢¶‚£Ö‚£Ä‚¢∏‚£ø‚£ß‚£∏‚£ø‚£ø‚°á‚†ò‚£ø‚£ø‚°ü‚£º‚†Å‚†≥‚£∂‚£ñ‚£í‚£≤‚†∂‚¢∏
‚£ø‚£ø‚£ø‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚†ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ü‚†°‚†¥‚£ø‚£∑‚£ø‚¢å‚†ò‚£ø‚£ø‚£ø‚£ø‚£ø‚°á‚¢∞‚£ø‚£ø‚¢°‚°è‚£∂‚£∂‚£∂‚£∂‚£∂‚£¨‚°Ñ‚£º
‚£ø‚£ø‚£ø‚£ø‚£Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚¢ª‚£ø‚£ø‚°ø‚†ø‚£ü‚£õ‚†õ‚†õ‚£õ‚£°‚£¨‚°ü‚£∑‚¢π‚£ø‚°ú‚†á‚†Å‚£π‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†ø‚¢É‚£æ‚¢Ä‚£∑‚†∂‚†∂‚†≠‚¢≠‚£ù‚¢É‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ß‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†±‚†Ç‚†â‚†õ‚¢â‚°¥‚†õ‚£º‚†ü‚¢ô‚°ø‚¢É‚°ô‚†Å‚¢õ‚£•‚††‚†æ‚†ø‚†ø‚†ø‚†ø‚£ø‚†ø‚†∑‚†ø‚†ü‚†Å‚†∫‚£ø‚£Æ‚£Ω‚£õ‚£≥‚†ñ‚¢∏‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ß‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢æ‚†Ö‚°æ‚†°‚†∂‚¢ã‚£†‚¢ø‚£ø‚£ø‚£ø‚£æ‚£á‚¢∫‚£ø‚£∑‚°à‚£∑‚£∞‚£¶‚£ø‚°Ü‚¢§‚£ø‚°∂‚£ø‚£ø‚£ø‚†ø‚†ø‚†É‚¢∏‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ç‚†Ä‚¢†‚°û‚£©‚†û‚¢ã‚£Ω‚†ø‚†ø‚†ø‚†è‚†æ‚†ø‚†ø‚†á‚£ø‚£ø‚£ø‚£ø‚£∑‚£æ‚£ø‚£ø‚£∑‚£ø‚†ü‚££‚£¥‚†ü‚£æ‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£¶‚°Ä‚†Ä‚†Ä‚†Ä‚¢†‚°Ä‚†Ä‚†Ä‚†à‚¢†‚°¥‚†ö‚†©‚†∂‚£ø‚£∑‚°æ‚¢ø‚£õ‚£•‚£Ä‚†à‚¢ô‚°ø‚†ü‚†ø‚£ù‚†ª‚†ø‚¢ü‚£´‚£¥‚£æ‚£ø‚†É‚£º‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚£Ñ‚†Ä‚†Ä‚¢ª‚£∑‚£Ñ‚†Ä‚†Ä‚°Ä‚†§‚†ñ‚£õ‚£≠‚£∂‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£∂‚£≠‚°õ‚¢ø‚£∂‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚¢Ä‚£ø‚£ø‚£ø
‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚£¶‚°Ä‚†õ‚†õ‚£ã‚£†‚£¥‚£∂‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚£Æ‚£õ‚£ø‚£ø‚£ø‚£ø‚£ø‚°ñ‚£∏‚£ø‚£ø‚£ø
```

---

# Exercise Hacking Time

## Show & Tell

Let's go around the table and read each other's phishing emails.
Then we do a vote on wrote the best email! : D

## Get phished

- I will log in to a VPS I have setup and start the phishing server for o365
- At my command, click this link [Totally legit link](https://login.know1t.dev/bFclQKxa)
- Authenticate against it 
- We will read through the logs together

---

# Get Phished

## Step 1: Click the link
## Step 2: Let user go through the authentication flow
## Step 3: Look in the Evilginx2 logs
## Step 4: Run this command

```bash
sessions
```
Followed by
```bash
sessions n
```

where `n` is the session that was captured. Copy paste the JSON.

## Step 5: Open the below URL in Brave

https://portal.office.com

## Step 6: Use the cookie editor

- Clear current cookies
- Import the cookie in clipboard

## Step 7: Refresh portal.office.com

- You should now be logged in as the phished user. 

## Step 8: Experiment :)

- Feel free to share tokens with each other to log in as the other user
- To Copy-paste cookies, use this chrome extension https://chrome.google.com/webstore/detail/cookie-editor/hlkenndednhfkekhgcdicdfddnkalmdm?hl=en

---

# Command & Control (c2) 
```
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£†‚†§‚†∂‚†∂‚£ñ‚°õ‚†õ‚†ø‚†ø‚†Ø‚†≠‚†ç‚†â‚£â‚†õ‚†ö‚†õ‚†≤‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚¢Ä‚°¥‚†ã‚†Å‚†Ä‚°â‚†Å‚¢ê‚£í‚†í‚†à‚†Å‚†Ä‚†Ä‚†Ä‚†à‚†Å‚¢Ç‚¢Ö‚°Ç‚†Ä‚†Ä‚†ò‚£ß‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚£º‚†Ä‚†Ä‚†Ä‚†Å‚†Ä‚†Ä‚†Ä‚†Ç‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£Ä‚£§‚£§‚£Ñ‚°à‚†à‚†Ä‚†Ä‚†Ä‚†ò‚£á‚†Ä‚†Ä‚†Ä
‚¢†‚°æ‚†°‚†Ñ‚†Ä‚†Ä‚†æ‚†ø‚†ø‚£∑‚£¶‚£§‚†Ä‚†Ä‚£æ‚£ã‚°§‚†ø‚†ø‚†ø‚†ø‚†Ü‚††‚¢Ä‚£Ä‚°í‚†º‚¢∑‚£Ñ‚†Ä
‚£ø‚†ä‚†ä‚†∂‚†∂‚¢¶‚£Ñ‚°Ñ‚†Ä‚¢Ä‚£ø‚†Ä‚†Ä‚†Ä‚†à‚†Å‚†Ä‚†Ä‚†ô‚†≥‚†¶‚†∂‚†û‚¢ã‚£ç‚†â‚¢≥‚°Ñ‚†à‚£ß
‚¢π‚£Ü‚°Ç‚¢Ä‚£ø‚†Ä‚†Ä‚°Ä‚¢¥‚£ü‚†Å‚†Ä‚¢Ä‚£†‚£ò‚¢≥‚°ñ‚†Ä‚†Ä‚£Ä‚£†‚°¥‚†û‚†ã‚£Ω‚†∑‚¢†‚†á‚†Ä‚£º
‚†Ä‚¢ª‚°Ä‚¢∏‚£ø‚£∑‚¢¶‚£Ñ‚£Ä‚£à‚£≥‚£Ü‚£Ä‚£Ä‚£§‚£≠‚£¥‚†ö‚†õ‚†â‚£π‚£ß‚°¥‚£æ‚†ã‚†Ä‚†Ä‚£ò‚°º‚†É
‚†Ä‚¢∏‚°á‚¢∏‚£∑‚£ø‚£§‚£è‚£â‚£ô‚£è‚£â‚£π‚£Å‚£Ä‚£†‚£º‚£∂‚°æ‚†ü‚¢ª‚£á‚°º‚†Å‚†Ä‚†Ä‚£∞‚†ã‚†Ä‚†Ä
‚†Ä‚¢∏‚°á‚†∏‚£ø‚°ø‚£ø‚¢ø‚°ø‚¢ø‚£ø‚†ø‚†ø‚£ø‚†õ‚†â‚†â‚¢ß‚†Ä‚£†‚°¥‚†ã‚†Ä‚†Ä‚†Ä‚£†‚†á‚†Ä‚†Ä‚†Ä
‚†Ä‚¢∏‚†Ä‚†Ä‚†π‚¢Ø‚£Ω‚£Ü‚£∑‚£Ä‚£ª‚£Ä‚£Ä‚£ø‚£Ñ‚£§‚£¥‚†æ‚¢õ‚°â‚¢Ñ‚°¢‚¢î‚£†‚†û‚†Å‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚¢∏‚†Ä‚†Ä‚†Ä‚†¢‚£Ä‚†Ä‚†à‚†â‚†â‚†â‚†â‚£â‚£Ä‚††‚£ê‚†¶‚†ë‚£ä‚°•‚†û‚†ã‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚¢∏‚°Ä‚†Ä‚†Å‚†Ç‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†í‚†à‚†Å‚£Ä‚°§‚†û‚†ã‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†ô‚†∂‚¢§‚£§‚£§‚£§‚£§‚°§‚†¥‚†ñ‚†ö‚†õ‚†â‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
```

---

# What is Command & control / C2?

Command & control (c2) a client / server infrastructure for infected users. 

- Using a c2 framework, a botmaster can send commands to be executed by the all the infected users
- Infected users are usually referred to as bots, hence "botnet"

## Typical Commands to execute are
- Extract cookies from web browsers
- Search the users files for passwords
- Log keystrokes

## Fun Commands you can execute
- Turn on web-camera
- Open Calculator
- Turn on microphone
- Play sounds 


---

# Command & Control Frameworks (2/2)

Using a c2 framework is in red team engagements is common today and has many benifits:

- Facilitates collaboration
- Centralizes management of bots
- I dont know what else, ask a red teamer : )

## Covenant

Open source .NET C2 Framework. This is what we will be using in our exercise in the next slide!


## Cobalt Strike

- Comercial product. Industry leader for C2 platform.
- It's so good that even the bad guys use it

link: https://www.cobaltstrike.com/

## Further Reading

Here is a larger list of c2 frameworks if you want to test and play around a bit.

https://github.com/tcostam/awesome-command-control

---

# Infecting Ourselves with Covenant


## Here's our covenant payload

If you didn't get it from the previous step here it is:

http://c2.know1t.dev/knowitsolutionscocreatefalkenberg-2023-com/program.exe

I will distribute it in the chat also

## What is this program?

This is a C# implant of the Covenant family. It targets dotnet 4.0, this should be pre-installed on most windows machines

# Who can Detect it?

Let's go to virustotal and see who can detect it! : )

# What happens when I run it?

I will demo what happens

## Login to arch Frogman box
## demonstrate that it is not detected by Anti-Virus
## Execute it
## Go to Covenant Command & Control Panel
## Execute command

- List Directory
- Take Screenshots
- Run Keylogger
- Notice the Persist* commands 

## Discussion:

- What are the necessary user-interaction steps to get this payload executing on a workstation for an attacker?
- What does the attack chain look like? From phish to infection
- What countermeasures do we need to defeat as an attacker?
- How can a developer design programs that circumvent these tactics?
---

# But wait ...

## "This isn't hacking, it's just social engineering..."

Yes. And it's the most effective way when you want to target a specific organisation.


# Another tactic is 
- to scan the internet for vulnerable services, and exploit and then recon.
- When you find a juicy potatoe then you launch attack. 
- Or sell initial access to highest bidder, and let someone else ransomware the infected network.

## Shodan.io

is a website that shows internet exposed services. Start here to find vulnerable services



---

# Summary

## We have talked about Cyber-kill chain
## We have talked about reconnaisence
## We have demoed how to phish
## We have looked at post infection

https://virustotal.com


